<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MindMapr ‚Äì Smart Revision Assistant</title>
<style>
  body {font-family: Arial, sans-serif; background-color: #eef4fb; margin: 0; padding: 0;}
  header {background-color: #1a73e8; color: white; text-align: center; padding: 20px;}
  .container {max-width: 600px; margin: 30px auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0px 5px 15px rgba(0,0,0,0.1);}
  button {background-color: #1a73e8; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; margin: 5px 0; width: 100%;}
  button:hover {background-color: #155fc4;}
  #output {background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 6px; padding: 15px; margin-top: 15px; min-height: 100px;}
  .option-btn {display: block; background-color: #f1f3f4; border: 1px solid #ccc; padding: 10px; margin: 6px 0; border-radius: 6px; cursor: pointer;}
  .option-btn:hover {background-color: #e0ebff;}
</style>
</head>
<body>

<header>
  <h1>MindMapr ‚Äì Smart Revision Assistant</h1>
</header>

<div class="container">
  <button onclick="addTopic()">‚ûï Add Topic</button>
  <button onclick="viewAll()">üìò View All Topics</button>
  <button onclick="searchTopic()">üîç Search Topic</button>
  <button onclick="quizMode()">üß© Quiz Mode</button>
  <button onclick="exportJSON()">üíæ Export JSON</button>
  <button onclick="clearData()">üóëÔ∏è Clear All Data</button>

  <div id="output"></div>
</div>

<script>
let data = JSON.parse(localStorage.getItem('mindmaprData') || '{}');

function saveData() {
    localStorage.setItem('mindmaprData', JSON.stringify(data));
}

function addTopic() {
    const topic = prompt("Enter topic name:");
    if (!topic) return alert("Topic name cannot be empty!");
    let points = [];
    while (true) {
        const point = prompt("Add key point (or type 'done' to finish):");
        if (point === null || point.toLowerCase() === 'done') break;
        if (point.trim()) points.push(point.trim());
    }
    if (!points.length) return alert("No points added!");
    data[topic] = (data[topic] || []).concat(points);
    saveData();
    alert(`‚úÖ Saved ${points.length} points for '${topic}'`);
}

function viewAll() {
    if (Object.keys(data).length === 0) {
        document.getElementById('output').innerHTML = "No topics added yet.";
        return;
    }
    let html = "";
    for (let topic in data) {
        html += `<h3>üìò ${topic}</h3><ul>`;
        data[topic].forEach((p, i) => html += `<li>${i + 1}. ${p}</li>`);
        html += `</ul>`;
    }
    document.getElementById('output').innerHTML = html;
}

function searchTopic() {
    const topic = prompt("Enter topic name to search:");
    if (!topic) return;
    if (data[topic]) {
        let html = `<h3>üìó ${topic}</h3><ul>`;
        data[topic].forEach((p, i) => html += `<li>${i + 1}. ${p}</li>`);
        html += `</ul>`;
        document.getElementById('output').innerHTML = html;
    } else {
        document.getElementById('output').innerHTML = "Topic not found!";
    }
}

function quizMode() {
    const topics = Object.keys(data);
    if (topics.length < 2) {
        document.getElementById('output').innerHTML = "Add at least 2 topics to start quiz mode.";
        return;
    }

    const correctTopic = topics[Math.floor(Math.random() * topics.length)];
    const points = data[correctTopic];
    const hint = points[Math.floor(Math.random() * points.length)];

    let options = [correctTopic];
    while (options.length < 4 && options.length < topics.length) {
        const rand = topics[Math.floor(Math.random() * topics.length)];
        if (!options.includes(rand)) options.push(rand);
    }
    options.sort(() => Math.random() - 0.5);

    let html = `<h3>üß† Which topic does this concept belong to?</h3>`;
    html += `<p><b>Hint:</b> ${hint}</p>`;
    options.forEach(opt => {
        html += `<div class='option-btn' onclick="checkAnswer('${opt}','${correctTopic}')">${opt}</div>`;
    });

    document.getElementById('output').innerHTML = html;
}

function checkAnswer(selected, correct) {
    if (selected === correct) {
        alert(`‚úÖ Correct! "${correct}" is the right topic.`);
    } else {
        alert(`‚ùå Wrong! Correct answer: "${correct}".`);
    }
    quizMode();
}

function clearData() {
    if (confirm("Are you sure you want to clear all data?")) {
        localStorage.removeItem('mindmaprData');
        data = {};
        document.getElementById('output').innerHTML = "All data cleared.";
    }
}

// ===== Export JSON Function =====
function exportJSON() {
    if (Object.keys(data).length === 0) {
        alert("No data to export!");
        return;
    }
    const blob = new Blob([JSON.stringify(data, null, 4)], { type: "application/json" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "mindmapr_export.json";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    alert("‚úÖ JSON exported successfully!");
}
</script>

</body>
</html>

    document.getElementById('output').innerHTML = html;
}

function checkAnswer(selected, correct) {
    if (selected === correct) {
        alert(`‚úÖ Correct! "${correct}" is the right topic.`);
    } else {
        alert(`‚ùå Wrong! Correct answer: "${correct}".`);
    }
    quizMode(); // automatically load next question
}

function clearData() {
    if (confirm("Are you sure you want to clear all data?")) {
        localStorage.removeItem('mindmaprData');
        data = {};
        document.getElementById('output').innerHTML = "All data cleared.";
    }
}
</script>

</body>
</html>
